(function(a){window.embedlyURLre=/(http|https):\/\/(\w+:{0,1}\w*@)?(\S+)(:[0-9]+)?(\/|\/([\w#!:.?+=&%@!\-\/]))?/;a.embedly=a.embedly||{};if(a.embedly.version){return}a.extend({embedly:function(j,p,m){var b=[];var o="http://api.embed.ly/";var c;if(typeof p!="undefined"){c=a.extend(a.embedly.defaults,p)}else{c=a.embedly.defaults}if(!c.urlRe){c.urlRe=window.embedlyURLre}if(typeof j=="string"){j=new Array(j)}if(typeof m!="undefined"){c.success=m}if(c.secure){o="https://api.embed.ly/"}if(c.success==null){c.success=function(i,s){var q,r=a(s.node);if(!(i)){return null}if((q=c.method)==="replace"){return r.replaceWith(i.code)}else{if(q==="after"){return r.after(i.code)}else{if(q==="afterParent"){return r.parent().after(i.code)}else{if(q==="replaceParent"){return r.parent().replaceWith(i.code)}}}}}}if(c.error==null){c.error=function(i,q){}}var l=function(i){return c.urlRe.test(i)};var n=function(q){var i="urls="+q;if(c.maxWidth!=null){i+="&maxwidth="+c.maxWidth}else{if(typeof dimensions!="undefined"){i+="&maxwidth="+dimensions.width}}if(c.maxHeight!=null){i+="&maxheight="+c.maxHeight}if(c.chars!=null){i+="&chars="+c.chars}if(c.words!=null){i+="&words="+c.words}i+="&wmode="+c.wmode;if(typeof c.key=="string"){i+="&key="+c.key}if(typeof c.autoplay=="string"||typeof c.autoplay=="boolean"){i+="&autoplay="+c.autoplay}if(c.width){i+="&width="+c.width}return i};var h=function(){if(typeof c.key=="string"){if(c.endpoint.search(/objectify/i)>=0){return o+"2/objectify"}else{if(c.endpoint.search(/preview/i)>=0){return o+"1/preview"}}}return o+"1/oembed"};var f=function(i,u){if(c.endpoint!="oembed"){return c.success(i,u)}var q,s,r,t;if((q=i.type)==="photo"){t=i.title||"";r=[];if(c.addImageStyles){if(c.maxWidth){units=isNaN(parseInt(c.maxWidth))?"":"px";r.push("max-width: "+(c.maxWidth)+units)}if(c.maxHeight){units=isNaN(parseInt(c.maxHeight))?"":"px";r.push("max-height: "+(c.maxHeight)+units)}}r=r.join(";");s="<a href='"+u.url+"' target='_blank'><img style='"+r+"' src='"+i.url+"' alt='"+t+"' /></a>"}else{if(q==="video"){s=i.html}else{if(q==="rich"){s=i.html}else{t=i.title||u.url;thumb=i.thumbnail_url?'<img src="'+i.thumbnail_url+'" class="thumb" />':"";description=i.description?'<div class="description">'+i.description+"</div>":"";provider=i.provider_name?'<a href="'+i.provider_url+'" class="provider">'+i.provider_name+"</a>":"";s=thumb+"<a href='"+u.url+"'>"+t+"</a>";s+=provider;s+=description}}}if(c.wrapElement&&c.wrapElement=="div"&&a.browser.msie&&a.browser.version<9){c.wrapElement="span"}if(c.wrapElement){s="<"+c.wrapElement+' class="'+c.className+'">'+s+"</"+c.wrapElement+">"}i.code=s;if(typeof u.node!="undefined"){a(u.node).data("oembed",i).trigger("embedly-oembed",[i])}return c.success(i,u)};var d=function(i){var r,t,s,q;s=a.map(i,function(v,u){if(u==0){if(v.node!==null){node=a(v.node);q={width:node.parent().width(),height:node.parent().height()}}}return encodeURIComponent(v.url)}).join(",");a.ajax({url:h(),dataType:"jsonp",data:n(s),success:function(u){return a.each(u,function(v,w){return w.type!="error"?f(w,i[v]):c.error(i[v].node,w)})}})};a.each(j,function(r,q){node=typeof c.elems!=="undefined"?c.elems[r]:null;if(typeof node!="undefined"&&!l(q)){a(node).data("oembed",false)}var s={url:q,error_code:400,error_message:"HTTP 400: Bad Request",type:"error"};return(q&&l(q))?b.push({url:q,node:node}):c.error(node,s)});var k=[];var g=b.length;for(var e=0;(0<=g?e<g:e>g);e+=20){k=k.concat(d(b.slice(e,e+20)))}if(c.elems){return c.elems}else{return this}}});a.embedly.version="2.1.6";a.embedly.defaults={endpoint:"oembed",chars:null,words:null,maxWidth:null,maxHeight:null,secure:false,frame:false,wmode:"opaque",autoplay:null,width:null,method:"replace",addImageStyles:true,wrapElement:"div",className:"embed",urlRe:null,key:null,elems:[],success:null,error:null};a.fn.embedly=function(d,g){var e=typeof d!="undefined"?d:{};if(typeof g!="undefined"){d.success=g}var f=new Array();var c=new Array();this.each(function(){if(typeof a(this).attr("href")!="undefined"){f.push(a(this).attr("href"));c.push(a(this))}else{a(this).find("a").each(function(){f.push(a(this).attr("href"));c.push(a(this))})}e.elems=c});var b=a.embedly(f,e);return this}})(jQuery);